\hypertarget{user__transaction_8c}{}\doxysection{src/local\+\_\+lib/user\+\_\+transaction.c File Reference}
\label{user__transaction_8c}\index{src/local\_lib/user\_transaction.c@{src/local\_lib/user\_transaction.c}}
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include \char`\"{}headers/user\+\_\+transaction.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}headers/simulation\+\_\+errors.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}headers/conf\+\_\+shm.\+h\char`\"{}}\newline
Include dependency graph for user\+\_\+transaction.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{user__transaction_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{user__transaction_8c_a3cadae3112a6a16fb452b1c1f79d7238}{DEBUG\+\_\+\+NOTIFY\+\_\+\+ACTIVITY\+\_\+\+RUNNING}}(mex)
\item 
\#define \mbox{\hyperlink{user__transaction_8c_af1bd9f6cef6eeb1f8e13af06c4ec9778}{DEBUG\+\_\+\+NOTIFY\+\_\+\+ACTIVITY\+\_\+\+DONE}}(mex)
\item 
\#define \mbox{\hyperlink{user__transaction_8c_a69277eff22ca52a411c09982c8be3ac8}{DEBUG\+\_\+\+MESSAGE}}(mex)
\item 
\#define \mbox{\hyperlink{user__transaction_8c_a6c474120d64f1aa7019f35511b21c50f}{DEBUG\+\_\+\+SIGNAL}}(mex,  signum)
\item 
\#define \mbox{\hyperlink{user__transaction_8c_a051f61037f4c5dd41bccc0c6b165c001}{DEBUG\+\_\+\+ERROR\+\_\+\+MESSAGE}}(mex)
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
pid\+\_\+t \mbox{\hyperlink{user__transaction_8c_a38c9b15db62422e3278255171ab20086}{extract\+\_\+user}} (int users\+\_\+num\mbox{[}$\,$\mbox{]}\mbox{[}2\mbox{]})
\item 
float \mbox{\hyperlink{user__transaction_8c_acf295f76abe58ee7bb9a9ff9893d359d}{gen\+\_\+amount}} (struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$user)
\begin{DoxyCompactList}\small\item\em Generate a random float number, representing the amount of a transaction with srand() level with getpid. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{user__transaction_8c_aa4a0ebd304fcd3fac7008881298f00ee}{user\+\_\+create}} (struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$self, float budget, int pid, \mbox{\hyperlink{user__transaction_8h_a8da11bb7001f47668dc77eb45e836a57}{Balance}} balance, \mbox{\hyperlink{user__transaction_8h_a2716d248a8d94065d106e7e28b9f5152}{Calc\+Cash\+Flow}} \mbox{\hyperlink{user__transaction_8c_a43560cdc24df530757a439519c168b21}{update\+\_\+cash\+\_\+flow}})
\item 
void \mbox{\hyperlink{user__transaction_8c_adaf2d10629cd9163c7aa828b7df95b18}{free\+\_\+user}} (struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$self)
\item 
\mbox{\hyperlink{boolean_8h_afdcfe6db5bea87bd493a3fe2c513d5ef}{Bool}} \mbox{\hyperlink{user__transaction_8c_a51e80fbe86b17b1a79525465a44ae7aa}{check\+\_\+balance}} (struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$self)
\item 
double \mbox{\hyperlink{user__transaction_8c_a7cef36bd17b42296f7cbffad20ba92a9}{calc\+\_\+balance}} (struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$self)
\item 
void \mbox{\hyperlink{user__transaction_8c_a653dc85368697debe55ecb3d9d3cd10f}{print\+\_\+cashflow}} (struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$self)
\item 
int \mbox{\hyperlink{user__transaction_8c_a43560cdc24df530757a439519c168b21}{update\+\_\+cash\+\_\+flow}} (struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$self, struct \mbox{\hyperlink{struct_transaction}{Transaction}} t)
\item 
int \mbox{\hyperlink{user__transaction_8c_a616e43192442081a6066e5e6c7494daa}{generate\+\_\+transaction}} (struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$self, pid\+\_\+t user\+\_\+proc\+\_\+pid, struct \mbox{\hyperlink{structshm__conf}{shm\+\_\+conf}} $\ast$\mbox{\hyperlink{structshm__conf}{shm\+\_\+conf}})
\item 
int \mbox{\hyperlink{user__transaction_8c_af4447aa6d2f3582dd56456c22ca4e33b}{extract\+\_\+node}} (int nodes\+\_\+num)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{user__transaction_8c_a051f61037f4c5dd41bccc0c6b165c001}\label{user__transaction_8c_a051f61037f4c5dd41bccc0c6b165c001}} 
\index{user\_transaction.c@{user\_transaction.c}!DEBUG\_ERROR\_MESSAGE@{DEBUG\_ERROR\_MESSAGE}}
\index{DEBUG\_ERROR\_MESSAGE@{DEBUG\_ERROR\_MESSAGE}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{DEBUG\_ERROR\_MESSAGE}{DEBUG\_ERROR\_MESSAGE}}
{\footnotesize\ttfamily \#define DEBUG\+\_\+\+ERROR\+\_\+\+MESSAGE(\begin{DoxyParamCaption}\item[{}]{mex }\end{DoxyParamCaption})}

\mbox{\Hypertarget{user__transaction_8c_a69277eff22ca52a411c09982c8be3ac8}\label{user__transaction_8c_a69277eff22ca52a411c09982c8be3ac8}} 
\index{user\_transaction.c@{user\_transaction.c}!DEBUG\_MESSAGE@{DEBUG\_MESSAGE}}
\index{DEBUG\_MESSAGE@{DEBUG\_MESSAGE}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{DEBUG\_MESSAGE}{DEBUG\_MESSAGE}}
{\footnotesize\ttfamily \#define DEBUG\+\_\+\+MESSAGE(\begin{DoxyParamCaption}\item[{}]{mex }\end{DoxyParamCaption})}

\mbox{\Hypertarget{user__transaction_8c_af1bd9f6cef6eeb1f8e13af06c4ec9778}\label{user__transaction_8c_af1bd9f6cef6eeb1f8e13af06c4ec9778}} 
\index{user\_transaction.c@{user\_transaction.c}!DEBUG\_NOTIFY\_ACTIVITY\_DONE@{DEBUG\_NOTIFY\_ACTIVITY\_DONE}}
\index{DEBUG\_NOTIFY\_ACTIVITY\_DONE@{DEBUG\_NOTIFY\_ACTIVITY\_DONE}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{DEBUG\_NOTIFY\_ACTIVITY\_DONE}{DEBUG\_NOTIFY\_ACTIVITY\_DONE}}
{\footnotesize\ttfamily \#define DEBUG\+\_\+\+NOTIFY\+\_\+\+ACTIVITY\+\_\+\+DONE(\begin{DoxyParamCaption}\item[{}]{mex }\end{DoxyParamCaption})}

\mbox{\Hypertarget{user__transaction_8c_a3cadae3112a6a16fb452b1c1f79d7238}\label{user__transaction_8c_a3cadae3112a6a16fb452b1c1f79d7238}} 
\index{user\_transaction.c@{user\_transaction.c}!DEBUG\_NOTIFY\_ACTIVITY\_RUNNING@{DEBUG\_NOTIFY\_ACTIVITY\_RUNNING}}
\index{DEBUG\_NOTIFY\_ACTIVITY\_RUNNING@{DEBUG\_NOTIFY\_ACTIVITY\_RUNNING}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{DEBUG\_NOTIFY\_ACTIVITY\_RUNNING}{DEBUG\_NOTIFY\_ACTIVITY\_RUNNING}}
{\footnotesize\ttfamily \#define DEBUG\+\_\+\+NOTIFY\+\_\+\+ACTIVITY\+\_\+\+RUNNING(\begin{DoxyParamCaption}\item[{}]{mex }\end{DoxyParamCaption})}

\mbox{\Hypertarget{user__transaction_8c_a6c474120d64f1aa7019f35511b21c50f}\label{user__transaction_8c_a6c474120d64f1aa7019f35511b21c50f}} 
\index{user\_transaction.c@{user\_transaction.c}!DEBUG\_SIGNAL@{DEBUG\_SIGNAL}}
\index{DEBUG\_SIGNAL@{DEBUG\_SIGNAL}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{DEBUG\_SIGNAL}{DEBUG\_SIGNAL}}
{\footnotesize\ttfamily \#define DEBUG\+\_\+\+SIGNAL(\begin{DoxyParamCaption}\item[{}]{mex,  }\item[{}]{signum }\end{DoxyParamCaption})}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{user__transaction_8c_a7cef36bd17b42296f7cbffad20ba92a9}\label{user__transaction_8c_a7cef36bd17b42296f7cbffad20ba92a9}} 
\index{user\_transaction.c@{user\_transaction.c}!calc\_balance@{calc\_balance}}
\index{calc\_balance@{calc\_balance}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{calc\_balance()}{calc\_balance()}}
{\footnotesize\ttfamily double calc\+\_\+balance (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$}]{self }\end{DoxyParamCaption})}

Calculate the balance
\begin{DoxyItemize}
\item balance = entries -\/ outcomes -\/ expect\+\_\+out; 
\begin{DoxyParams}{Parameters}
{\em self} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the current balance 
\end{DoxyReturn}

\end{DoxyItemize}\mbox{\Hypertarget{user__transaction_8c_a51e80fbe86b17b1a79525465a44ae7aa}\label{user__transaction_8c_a51e80fbe86b17b1a79525465a44ae7aa}} 
\index{user\_transaction.c@{user\_transaction.c}!check\_balance@{check\_balance}}
\index{check\_balance@{check\_balance}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{check\_balance()}{check\_balance()}}
{\footnotesize\ttfamily \mbox{\hyperlink{boolean_8h_afdcfe6db5bea87bd493a3fe2c513d5ef}{Bool}} check\+\_\+balance (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$}]{self }\end{DoxyParamCaption})}

Check if balance is \texorpdfstring{$>$}{>}= 2 
\begin{DoxyParams}{Parameters}
{\em self} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
TRUE if balance \texorpdfstring{$>$}{>}=2, FALSE otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{user__transaction_8c_af4447aa6d2f3582dd56456c22ca4e33b}\label{user__transaction_8c_af4447aa6d2f3582dd56456c22ca4e33b}} 
\index{user\_transaction.c@{user\_transaction.c}!extract\_node@{extract\_node}}
\index{extract\_node@{extract\_node}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{extract\_node()}{extract\_node()}}
{\footnotesize\ttfamily int extract\+\_\+node (\begin{DoxyParamCaption}\item[{int}]{nodes\+\_\+num }\end{DoxyParamCaption})}

Extract randomly a node id from 0 up to nodes\+\_\+num 
\begin{DoxyParams}{Parameters}
{\em nodes\+\_\+num} & limit for random extraction \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the random id extracted 
\end{DoxyReturn}
\mbox{\Hypertarget{user__transaction_8c_a38c9b15db62422e3278255171ab20086}\label{user__transaction_8c_a38c9b15db62422e3278255171ab20086}} 
\index{user\_transaction.c@{user\_transaction.c}!extract\_user@{extract\_user}}
\index{extract\_user@{extract\_user}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{extract\_user()}{extract\_user()}}
{\footnotesize\ttfamily pid\+\_\+t extract\+\_\+user (\begin{DoxyParamCaption}\item[{int}]{users\+\_\+num\mbox{[}$\,$\mbox{]}\mbox{[}2\mbox{]} }\end{DoxyParamCaption})}

Select a user pid from the vector pointer users\+\_\+num randomly 
\begin{DoxyParams}{Parameters}
{\em users\+\_\+num} & the pointer to the vector of users\+\_\+pids \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the pid\+\_\+t of the user selected randomly 
\end{DoxyReturn}
\mbox{\Hypertarget{user__transaction_8c_adaf2d10629cd9163c7aa828b7df95b18}\label{user__transaction_8c_adaf2d10629cd9163c7aa828b7df95b18}} 
\index{user\_transaction.c@{user\_transaction.c}!free\_user@{free\_user}}
\index{free\_user@{free\_user}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{free\_user()}{free\_user()}}
{\footnotesize\ttfamily void free\+\_\+user (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$}]{self }\end{DoxyParamCaption})}

Free the memory from the queue list of transactions; 
\begin{DoxyParams}{Parameters}
{\em self} & \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{user__transaction_8c_acf295f76abe58ee7bb9a9ff9893d359d}\label{user__transaction_8c_acf295f76abe58ee7bb9a9ff9893d359d}} 
\index{user\_transaction.c@{user\_transaction.c}!gen\_amount@{gen\_amount}}
\index{gen\_amount@{gen\_amount}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{gen\_amount()}{gen\_amount()}}
{\footnotesize\ttfamily float gen\+\_\+amount (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$}]{user }\end{DoxyParamCaption})}



Generate a random float number, representing the amount of a transaction with srand() level with getpid. 


\begin{DoxyParams}{Parameters}
{\em user} & the adt of the user to extract the random amount from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the amount generated randomly 
\end{DoxyReturn}
\mbox{\Hypertarget{user__transaction_8c_a616e43192442081a6066e5e6c7494daa}\label{user__transaction_8c_a616e43192442081a6066e5e6c7494daa}} 
\index{user\_transaction.c@{user\_transaction.c}!generate\_transaction@{generate\_transaction}}
\index{generate\_transaction@{generate\_transaction}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{generate\_transaction()}{generate\_transaction()}}
{\footnotesize\ttfamily int generate\+\_\+transaction (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$}]{self,  }\item[{pid\+\_\+t}]{user\+\_\+proc\+\_\+pid,  }\item[{struct \mbox{\hyperlink{structshm__conf}{shm\+\_\+conf}} $\ast$}]{shm\+\_\+conf }\end{DoxyParamCaption})}

Generate a new transaction for the self user and add it to in\+\_\+progress queue of the transaction 
\begin{DoxyParams}{Parameters}
{\em self} & pointer to the transaction to be generated \\
\hline
{\em user\+\_\+proc\+\_\+pid} & pid of the user generating the transaction \\
\hline
{\em users\+\_\+num} & pointer to a vector of users available \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/1 in case o failure. 0 otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{user__transaction_8c_a653dc85368697debe55ecb3d9d3cd10f}\label{user__transaction_8c_a653dc85368697debe55ecb3d9d3cd10f}} 
\index{user\_transaction.c@{user\_transaction.c}!print\_cashflow@{print\_cashflow}}
\index{print\_cashflow@{print\_cashflow}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{print\_cashflow()}{print\_cashflow()}}
{\footnotesize\ttfamily void print\+\_\+cashflow (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$}]{self }\end{DoxyParamCaption})}

Print the cashflow info 
\begin{DoxyParams}{Parameters}
{\em self} & the user to be printed \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{user__transaction_8c_a43560cdc24df530757a439519c168b21}\label{user__transaction_8c_a43560cdc24df530757a439519c168b21}} 
\index{user\_transaction.c@{user\_transaction.c}!update\_cash\_flow@{update\_cash\_flow}}
\index{update\_cash\_flow@{update\_cash\_flow}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{update\_cash\_flow()}{update\_cash\_flow()}}
{\footnotesize\ttfamily int update\+\_\+cash\+\_\+flow (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$}]{self,  }\item[{struct \mbox{\hyperlink{struct_transaction}{Transaction}}}]{t }\end{DoxyParamCaption})}

Update entries, outcomes and budget based on transaction 
\begin{DoxyParams}{Parameters}
{\em t} & the transaction arrived \\
\hline
{\em self} & current user \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/1 in case of failure, 0 otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{user__transaction_8c_aa4a0ebd304fcd3fac7008881298f00ee}\label{user__transaction_8c_aa4a0ebd304fcd3fac7008881298f00ee}} 
\index{user\_transaction.c@{user\_transaction.c}!user\_create@{user\_create}}
\index{user\_create@{user\_create}!user\_transaction.c@{user\_transaction.c}}
\doxysubsubsection{\texorpdfstring{user\_create()}{user\_create()}}
{\footnotesize\ttfamily void user\+\_\+create (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} $\ast$}]{self,  }\item[{float}]{budget,  }\item[{int}]{pid,  }\item[{\mbox{\hyperlink{user__transaction_8h_a8da11bb7001f47668dc77eb45e836a57}{Balance}}}]{balance,  }\item[{\mbox{\hyperlink{user__transaction_8h_a2716d248a8d94065d106e7e28b9f5152}{Calc\+Cash\+Flow}}}]{update\+\_\+cash\+\_\+flow }\end{DoxyParamCaption})}

Initialize the \mbox{\hyperlink{structuser__transaction}{user\+\_\+transaction}} to default value with entries set as budget given 
\begin{DoxyParams}{Parameters}
{\em self} & current user \\
\hline
{\em budget} & to start \\
\hline
{\em pid} & current proc\+\_\+pid \\
\hline
{\em balance} & pointer to function that calc balance \\
\hline
{\em update\+\_\+cash\+\_\+flow} & pointer to function that update cash flow $\vert$ and budget!! \\
\hline
\end{DoxyParams}
